ini cara buatnya gimna?

ai_agent/
  __init__.py
  config/
    agent.yaml            # base_url, timeouts, strategi (depth, retries), mode (staging/prod)
    auth.yaml             # kredensial/flow login per role (Admin_HC, Employee, dsb.)
    policy.yaml           # ringkas RBAC -> allowed/denied per endpoint×role
  data/
    openapi.json          # ekspor Swagger kamu
    rbac_matrix.csv       # matriks role-permission (jika sumbernya CSV)
  prompts/
    planner.md            # prompt untuk menyusun rencana uji dari OpenAPI+RBAC
    tester.md             # prompt untuk merancang skenario mutasi (IDOR/BOLA)
    triager.md            # prompt untuk merangkum temuan & root cause singkat
  core/
    orchestrator.py       # loop: Plan → Generate → Execute → Observe → Reflect → Report
    tools_http.py         # klien HTTP, retry, rate-limit, capture req/resp
    tools_auth.py         # login per role, token cache/refresh
    tools_postman.py      # opsional: jalankan Newman collection & ambil hasil
    tools_zap.py          # opsional: trigger passive/active scan ZAP
    memory.py             # state: daftar endpoint, token per role, hasil uji
    evaluators.py         # TP/FP/FN/TN, precision/recall/F1, coverage endpoint×role
    reporters.py          # JSON/Markdown/CSV laporan + bukti (artifacts)
    utils.py              # helper: load OpenAPI, normalisasi path, dsb.
  runs/
    logs/                 # log eksekusi (per run)
    artifacts/            # bukti: request/response, HAR, screenshot ZAP, dsb.
  scripts/
    run_agent.py          # CLI entrypoint
    generate_tests.py     # (dev) buat draft test dari OpenAPI+RBAC
.env.example              # OPENAI_API_KEY, BASE_URL, ZAP_ADDR, dsb.

Gambaran besar (biar kebayang)

Agen ini kerja dengan tiga input utama:

OpenAPI (daftar endpoint & param)

Kebijakan RBAC (siapa boleh ke endpoint mana, dalam konteks self vs non-self)

Kredensial login per peran (buat dapat token)

Lalu agen menjalankan siklus: Plan → Execute → Report.
Output akhirnya: artefak request–response dan laporan metrik (confusion, precision/recall/F1, coverage).

Penjelasan tiap bagian + apa yang kamu isi
ai_agent/__init__.py

Menandai folder jadi paket Python.

Tidak wajib ada isi khusus; cukup identitas paket (boleh juga cantumkan versi).
config/ (semua pengaturan ada di sini)

agent.yaml

Tempat setelan runtime.

Kamu isi:

alamat API target (base_url), batas waktu, jumlah percobaan ulang (retries), kedalaman eksplorasi (depth).

mode eksekusi (staging/prod), paralelisme (concurrency).

lokasi folder artefak & log.

opsi “dry run” (kalau ingin uji alur tanpa benar-benar memanggil API).

Dampaknya: mengontrol cara agen menembak API dan menyimpan bukti.

auth.yaml

Cara login per role untuk mendapat token.

Kamu isi:

daftar peran (mis. Employee, Admin_HC).

alur autentikasi (mis. password, static token), endpoint login, dan payloadnya.

“jalur” pengambilan token dari respons (mis. field JSON mana).

“user_id” per role (dipakai untuk skenario self vs other).

Dampaknya: agen bisa bertindak “sebagai” tiap peran secara autentik.

policy.yaml

Ringkasan kebenaran RBAC per kombinasi role–method–path.

Kamu isi:

daftar role yang valid.

daftar aturan (rules): untuk tiap endpoint (method + path placeholder), siapa yang allow dan siapa yang deny.

Khusus akses “self only”: tandai allow untuk self:true dan deny untuk self:false.

Dampaknya: agen tahu ekspektasi status (allowed → 200, denied → 401/403) saat mengevaluasi hasil.

data/ (sumber spesifikasi & matriks)

openapi.json

Ekspor spesifikasi API (Swagger/OpenAPI).

Kamu taruh file kontrak API di sini (path, parameter, respons).

Dampaknya: agen menginventaris endpoint dan memprioritaskan yang sensitif (mis. ada {id}).

rbac_matrix.csv (opsional)

Matriks ringkas role–resource–action–allowed (hasil olahan dari basis data RBAC jika ada).

Isinya memudahkan pelaporan/analitik; untuk eksekusi, yang utama tetap policy.yaml.

prompts/ (opsional—kalau mau pakai LLM)

planner.md

Naskah instruksi untuk menyusun rencana uji dari OpenAPI+RBAC (prioritas endpoint, variasi skenario).

tester.md

Naskah instruksi untuk membentuk skenario mutasi IDOR/BOLA (self vs other, manipulasi parameter sensitif).

triager.md

Naskah instruksi untuk merangkum temuan + dugaan akar masalah dari hasil request–response.

Catatan: tanpa LLM pun agen tetap bisa jalan; bagian ini untuk “membumbui” perencanaan/triage otomatis.
core/ (otaknya agen)

orchestrator.py

Pengarah alur end-to-end: Plan → Generate → Execute → Observe → Reflect → Report.

Tanggung jawab:

merencanakan kombinasi role × endpoint (mode self dan other),

menjalankan panggilan API per test case,

menyimpan hasil ke memori/artefak,

memanggil evaluator + reporter.

tools_http.py

Klien HTTP internal:

menyusun header (termasuk Authorization), menerapkan timeout/retry/rate-limit,

merekam permintaan & respons sebagai artefak untuk audit/triase.

tools_auth.py

Manajer autentikasi:

login sesuai skema di auth.yaml,

menyimpan cache token per role (dan menyediakannya saat dibutuhkan),

menyediakan nilai user_id untuk membedakan self vs other ketika mengganti placeholder {id}.

tools_postman.py (opsional)

Jembatan untuk mengeksekusi koleksi Postman via Newman bila kamu sudah punya test collection lama dan ingin digabungkan.

tools_zap.py (opsional)

Hook ke OWASP ZAP untuk passive/active scan; memperkaya deteksi selain BAC.

memory.py

Struktur penyimpanan sementara:

daftar test case yang direncanakan/dieksekusi,

hasil (status code, body yang relevan),

dipakai orchestrator dan evaluator untuk menilai kinerja.

evaluators.py

Mesin penilaian:

menerjemahkan policy.yaml menjadi ekspektasi status (allow/deny),

membangun confusion matrix (TP/FP/FN/TN),

menghitung precision, recall, F1, accuracy,

menghitung coverage (berapa banyak kombinasi role–endpoint yang benar-benar diuji).

Penting untuk skripsi: di sinilah metrik kuantitatif dihasilkan.
reporters.py

Penyusun laporan:

menulis output (umumnya JSON; bisa juga CSV/Markdown) berisi metrik & daftar hasil,

menyertakan pointer ke artefak agar temuan mudah diverifikasi.

utils.py

Fungsi bantu:

pembaca YAML/JSON, normalisasi path API, ekstraksi daftar path dari OpenAPI,

util kecil lain yang dipakai lintas modul.

runs/ (hasil eksekusi)

logs/

Catatan proses per-run (informasi eksekusi, error ringkas).

artifacts/

Bukti uji: tiap request–response disimpan (termasuk header, URL, body, status).

Penting untuk triase, dokumentasi, dan lampiran bukti di laporan akademik.

scripts/ (cara menjalankan & util dev)

run_agent.py

Titik masuk CLI untuk menjalankan agen.

Saat kamu jalankan, dia akan:

memuat konfigurasi config/,

membaca data/openapi.json,

membentuk & mengeksekusi test case berdasarkan policy.yaml,

menyimpan artefak dan membuat laporan di runs/.

generate_tests.py (opsional)

Alat bantu pengembang untuk membuat draf test dari OpenAPI+RBAC, kalau mau dipisah dari orchestrator.

.env.example

Contoh variabel lingkungan (API key, base URL, alamat ZAP, dsb.).

Kamu salin/ubah jadi .env untuk penggunaan lokal, dan jangan commit nilai rahasia aslinya

